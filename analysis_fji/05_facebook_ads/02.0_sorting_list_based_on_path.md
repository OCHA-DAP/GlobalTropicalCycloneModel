```python
import matplotlib.pyplot as plt
from matplotlib.colors import Normalize
import matplotlib.patches as mpatches
import numpy as np
import os
from pathlib import Path
import pandas as pd
# import shap
from sklearn.metrics import mean_squared_error
from xgboost.sklearn import XGBRegressor
import geopandas as gpd
from climada.hazard import Centroids, TCTracks, TropCyclone
from shapely.geometry import LineString

from utils import get_combined_dataset, xgb_model_combined_data_LOOCV, get_training_dataset_complete, get_municipality_grids
```


```python
input_dir = (
    Path(os.getenv("STORM_DATA_DIR"))
    / "analysis_fji/02_new_model_input/02_housing_damage/input/"
)
actual_mun_dmg = pd.read_csv(input_dir / "fji_building_damage_mun_complete.csv")
actual_mun_dmg['typhoon'] = actual_mun_dmg['typhoon'].str.upper()

# Load Fiji Shapefile
fiji = gpd.read_file(
    input_dir / "adm2_shp_fixed.gpkg"
)
fiji = fiji.to_crs('EPSG:4326')

# Load grid
grid_dir = (
    Path(os.getenv("STORM_DATA_DIR"))
    / "analysis_fji/02_new_model_input/02_housing_damage/output/"
)
grid = gpd.read_file(grid_dir / "fji_0.1_degree_grid_land_overlap_new.gpkg")
grid_new = pd.read_csv(grid_dir / "grid_0.01_bld_locations.csv")

# Load municipality info
grid_mun_info = pd.read_csv(input_dir / "grid_0.01_municipality_info.csv")

# Load typhoon track
tracks_dir = (
    Path(os.getenv("STORM_DATA_DIR"))
    / "analysis_fji/02_new_model_input/01_windfield"
)
typhoons_info = pd.read_csv(tracks_dir / "typhoons.csv")
typhoons_info.typhoon_name = typhoons_info.typhoon_name.str.upper()
cyclones = actual_mun_dmg['typhoon'].unique()
intersection = typhoons_info[typhoons_info['typhoon_name'].isin(cyclones)].drop_duplicates(keep='last', subset = ['typhoon_name'])
```

## Run model


```python
# Load dataset
df_combined = get_combined_dataset()
df_fji = df_combined[df_combined.country == 'fji']

# Typhoons
fji_typhoons = df_fji.typhoon_name.unique()

# Features
features = [
    "wind_speed",
    "track_distance",
    "total_houses",
    "rainfall_max_6h",
    "rainfall_max_24h",
    "coast_length",
    "with_coast",
    "mean_elev",
    "mean_slope",
]

# Stratification
dmg = np.array(df_fji.percent_houses_damaged.to_list())
zero_dmg = np.round((np.count_nonzero(dmg == 0) / len(dmg)) , 2 )

# Define ranges for each group
x0 = list(np.linspace(0, zero_dmg, 1))   # zero damage
x1 = list(np.linspace(zero_dmg, 0.93, 2))  # almost no damage
x2 = list(np.linspace(0.935, 1, 5))  # all the damage
x3=x0+x1+x2

bins = []
for i in x3:
    bins.append(np.quantile(dmg, i))

# Histogram after stratification
samples_per_bin_fji, bins_def_fji = np.histogram(dmg, bins=bins)

# Define number of bins
num_bins_fji = len(samples_per_bin_fji)

# For future plots
str_bin_fji = []
for i in range(len(bins_def_fji[:-1])):
    a = str(np.round(bins_def_fji[i+1],3))
    b = str(np.round(bins_def_fji[i],3))
    str_bin_fji.append('{} - {}'.format(b,a))
```


```python
# Run XGB
y_test_typhoon, y_pred_typhoon, rmse_strat, avg_error_strat = xgb_model_combined_data_LOOCV(
    df_combined=df_combined,
    df_fji=df_fji,
    bins=bins_def_fji,
    fji_weight=3,
    features=features
)
```

Get complete dataset at grid level


```python
# Since we need the grid id, we load this dataset. Is the same one as df_fji (same orde rof rows, same information, etc)
# but we the feature 'grid_point_id' not present in df_fji from get_combined_dataset()
# (here we drop this value because grid ids from Fiji and philippines are different)

df_fji_complete = get_training_dataset_complete()
df_fji_complete = df_fji_complete.rename({
    "mean_altitude": "mean_elev",
    "total_buildings": "total_houses"
}, axis=1)
df_fji_complete = df_fji_complete[features + ['typhoon_name', 'grid_point_id', 'Centroid', 'perc_dmg_grid']]

# Add feature "predictive_damage"
df_fji_complete['predicted_damage'] = np.concatenate(y_pred_typhoon)

# Merge with grid to add geometry
df_fji_complete_merged = grid[['id','geometry']].merge(df_fji_complete, left_on='id', right_on='grid_point_id')
df_fji_complete_merged = gpd.GeoDataFrame(df_fji_complete_merged, geometry='geometry')
```

Get complete dataset at municipality level


```python
# Calculate buildings destroyed by municipality and % of buildings destroyed by mun
mun_id = get_municipality_grids()[['id','NAME_2']]
def num_bld_destroyed_mun(mun, typhoon, real = False):
    mun_ids = mun_id[mun_id.NAME_2 == mun].id.to_list()
    cells_in_mun = df_fji_complete[df_fji_complete.typhoon_name == typhoon].set_index('grid_point_id').loc[mun_ids]
    # Drop cells with 0 buildings
    #cells_in_mun = cells_in_mun[cells_in_mun.total_houses !=0]

    if real:
        damage_grid = np.array(cells_in_mun.perc_dmg_grid.to_list()) # Real dmg
    else:
        damage_grid = np.array(cells_in_mun.predicted_damage.to_list()) # Dmg predicted by cell

    # Number of buildings
    N_bld_grid = np.array(cells_in_mun.total_houses.to_list()) # Bld by cell
    N_bld_mun = np.sum(N_bld_grid) # Total bld in mun

    # Calculate % of buildings (and N of bld) destroyed by mun
    N_bld_dest_pred_mun = np.sum(damage_grid) * (N_bld_mun / 100)
    perc_destroyed_mun = np.sum(damage_grid)

    return N_bld_dest_pred_mun, perc_destroyed_mun
```

## List of affected areas, input at grid level


```python
# First of all, select typhoon
typhoon = 'WINSTON'
df_typhoon = df_fji_complete_merged[df_fji_complete_merged.typhoon_name == typhoon]

# Load track
id = intersection[intersection['typhoon_name'] == typhoon].typhoon_id.to_list()
track = TCTracks.from_ibtracs_netcdf(storm_id=id)
tc_track = track.get_track()

points_ib = gpd.points_from_xy(tc_track.lon, tc_track.lat)
tc_track_line_ib = LineString(points_ib)

geometries_ib = gpd.GeoSeries([tc_track_line_ib])
line_gdf_ib = gpd.GeoDataFrame(geometry=geometries_ib)

cmap='Reds'
fig, ax = plt.subplots(1,2, figsize=(10,6))

df_typhoon.plot(column='perc_dmg_grid', cmap=cmap, linewidth=0.8, ax=ax[0], edgecolor='0.8', legend=True)
df_typhoon.plot(column='predicted_damage', cmap=cmap, linewidth=0.8, ax=ax[1], edgecolor='0.8', legend=True)
line_gdf_ib.plot(ax=ax[0], color='k', linewidth=1, label='Typhoon track')
line_gdf_ib.plot(ax=ax[1], color='k', linewidth=1, label='Typhoon track')

ax[0].set_title('Actual Damage by municipality')
ax[1].set_title('Predicted Damage by municipality')
ax[0].axis('off')
ax[1].axis('off')
ax[0].set_xlim(176.5, 182)
ax[0].set_ylim(-20, -15)
ax[1].set_xlim(176.5, 182)
ax[1].set_ylim(-20, -15)

plt.suptitle('Typhoon {}'.format(typhoon), y=1)
plt.tight_layout()
plt.show()
```



![png](02.0_sorting_list_based_on_path_files/02.0_sorting_list_based_on_path_10_0.png)



Get list of cells with high damage predicted


```python
threshold = 5 # percent of damage
pred_damage_cells = df_fji_complete_merged[df_fji_complete_merged.predicted_damage >= threshold][['grid_point_id', 'predicted_damage']]

# Load new grid (0,01 degree resolution grid) and contemplate affected areas
df_affected = grid_new.merge(pred_damage_cells, on='grid_point_id')
df_affected = df_affected[df_affected.numbuildings != 0] # Drop 0 bluildings mini-cells

# New grid sorted by number of buildings
df_out_grid_level = df_affected.sort_values('numbuildings', ascending=False).drop_duplicates(subset='id').reset_index(drop=True)
```


```python
df_out_grid_level.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>grid_point_id</th>
      <th>IWI</th>
      <th>id</th>
      <th>Longitude</th>
      <th>Latitude</th>
      <th>Centroid</th>
      <th>geometry</th>
      <th>numbuildings</th>
      <th>predicted_damage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>867</td>
      <td>86.0</td>
      <td>89672</td>
      <td>177.395</td>
      <td>-17.825</td>
      <td>177.39E_-17.82N</td>
      <td>POLYGON ((177.3899999999992 -17.81999999999934...</td>
      <td>414</td>
      <td>5.997177</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1679</td>
      <td>78.4</td>
      <td>166790</td>
      <td>178.165</td>
      <td>-18.235</td>
      <td>178.16E_-18.23N</td>
      <td>POLYGON ((178.1599999999985 -18.22999999999941...</td>
      <td>384</td>
      <td>5.751749</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1679</td>
      <td>78.4</td>
      <td>166789</td>
      <td>178.165</td>
      <td>-18.225</td>
      <td>178.16E_-18.22N</td>
      <td>POLYGON ((178.1599999999985 -18.21999999999941...</td>
      <td>351</td>
      <td>5.751749</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1578</td>
      <td>78.4</td>
      <td>158783</td>
      <td>178.085</td>
      <td>-18.245</td>
      <td>178.08E_-18.24N</td>
      <td>POLYGON ((178.07999999999856 -18.2399999999994...</td>
      <td>351</td>
      <td>12.247775</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1679</td>
      <td>78.4</td>
      <td>166788</td>
      <td>178.165</td>
      <td>-18.215</td>
      <td>178.16E_-18.21N</td>
      <td>POLYGON ((178.1599999999985 -18.20999999999940...</td>
      <td>246</td>
      <td>5.751749</td>
    </tr>
  </tbody>
</table>
</div>



## List of affected areas, input at mun level


```python
typhoon = 'WINSTON'

# Create new features in shapefile with predicted and real damage
def calculate_actual_perc_dmg(x, i):
    try:
        return num_bld_destroyed_mun(mun=x['NAME_2'], typhoon=typhoon, real=True)[i]
    except:
        return 0
def calculate_pred_perc_dmg(x, i):
    try:
        return num_bld_destroyed_mun(mun=x['NAME_2'], typhoon=typhoon, real=False)[i]
    except:
        return 0
fiji['actual_perc_dmg'] = fiji.apply(calculate_actual_perc_dmg, i=1, axis=1)
fiji['actual_bld_dest'] = fiji.apply(calculate_actual_perc_dmg, i=0, axis=1)
fiji['pred_perc_dmg'] = fiji.apply(calculate_pred_perc_dmg, i=1, axis=1)
fiji['pred_bld_dmg'] = fiji.apply(calculate_pred_perc_dmg, i=0, axis=1)
fiji['prediction_error'] = fiji['actual_perc_dmg'] - fiji['pred_perc_dmg'] # in percentual points
```


```python
# Plotting the data
cmap='Reds'
cmap_blue = 'Blues'
cmap_red = 'Reds_r'
fig, ax = plt.subplots(1, 3, figsize=(15, 5))
vmax = max([fiji.actual_perc_dmg.max(), fiji.pred_perc_dmg.max()])

# Check prediction_error column for values > 0 and < 0
positive_error = fiji[fiji['prediction_error'] > 0]
negative_error = fiji[fiji['prediction_error'] < 0]

# Plotting the maps
fiji_plot_1 = fiji.plot(column='actual_perc_dmg', cmap=cmap, linewidth=0.2, ax=ax[0], edgecolor='0.3', legend=True)
fiji_plot_2 = fiji.plot(column='pred_perc_dmg', cmap=cmap, linewidth=0.2, ax=ax[1], edgecolor='0.3', legend=True)
fiji_plot_3_blue = positive_error.plot(column='prediction_error', cmap=cmap_blue, linewidth=0.2, ax=ax[2], edgecolor='0.3', legend=True)
fiji_plot_3_red = negative_error.plot(column='prediction_error', cmap=cmap_red, linewidth=0.2, ax=ax[2], edgecolor='0.3', legend=True)


line_gdf_ib.plot(ax=ax[0], color='k', linewidth=1, label='Typhoon track')  # Plot the LineString in black
line_gdf_ib.plot(ax=ax[1], color='k', linewidth=1, label='Typhoon track')  # Plot the LineString in black
line_gdf_ib.plot(ax=ax[2], color='k', linewidth=1, label='Typhoon track')  # Plot the LineString in black

# Create custom legends
blue_patch = mpatches.Patch(color='#6495ED', label='Underestimated damage')
red_patch = mpatches.Patch(color='#800000', label='Overestimated damage')
ax[2].legend(handles=[blue_patch, red_patch], loc='lower left', bbox_to_anchor=(-0.05, -0.2))

ax[0].set_title('Actual Damage by municipality')
ax[1].set_title('Predicted Damage by municipality')
ax[2].set_title('Prediction Error \n $actual_{dmg} - predicted_{dmg}$ \n(in percentage points)')
ax[0].axis('off')
ax[1].axis('off')
ax[2].axis('off')

# All Fiji map
ax[0].set_xlim(176, 182)
ax[0].set_ylim(-20, -12)
ax[1].set_xlim(176, 182)
ax[1].set_ylim(-20, -12)
ax[2].set_xlim(176, 182)
ax[2].set_ylim(-20, -12)

plt.suptitle('Typhoon {}'.format(typhoon), y=1.1)
plt.tight_layout()
plt.show()
```



![png](02.0_sorting_list_based_on_path_files/02.0_sorting_list_based_on_path_16_0.png)



Get list of municipalities with High predicted Damage


```python
threshold = 10 # percent of damage
pred_damage_mun = fiji[fiji.pred_perc_dmg >= threshold][['NAME_2', 'geometry', 'pred_perc_dmg']]

# Add id information
add_mun_info = pred_damage_mun.merge(grid_mun_info[['NAME_2', 'id']], on='NAME_2')[['NAME_2', 'id', 'pred_perc_dmg']]

# Load new grid (0,01 degree resolution grid) and contemplate affected areas
df_affected = add_mun_info.merge(grid_new, on ='id')
df_affected = df_affected[df_affected.numbuildings != 0] # Drop 0 bluildings mini-cells

df_out_mun_level = df_affected.sort_values('numbuildings', ascending=False).reset_index(drop=True)
```


```python
df_out_mun_level.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME_2</th>
      <th>id</th>
      <th>pred_perc_dmg</th>
      <th>grid_point_id</th>
      <th>IWI</th>
      <th>Longitude</th>
      <th>Latitude</th>
      <th>Centroid</th>
      <th>geometry</th>
      <th>numbuildings</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Rewa</td>
      <td>195808</td>
      <td>11.315262</td>
      <td>1981</td>
      <td>82.2</td>
      <td>178.455</td>
      <td>-18.125</td>
      <td>178.45E_-18.12N</td>
      <td>POLYGON ((178.44999999999823 -18.1199999999993...</td>
      <td>1464</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ba</td>
      <td>94657</td>
      <td>27.914065</td>
      <td>966</td>
      <td>86.0</td>
      <td>177.445</td>
      <td>-17.625</td>
      <td>177.44E_-17.62N</td>
      <td>POLYGON ((177.43999999999915 -17.6199999999993...</td>
      <td>1197</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Rewa</td>
      <td>195809</td>
      <td>11.315262</td>
      <td>1981</td>
      <td>82.2</td>
      <td>178.455</td>
      <td>-18.135</td>
      <td>178.45E_-18.13N</td>
      <td>POLYGON ((178.44999999999823 -18.1299999999993...</td>
      <td>1146</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Rewa</td>
      <td>194808</td>
      <td>11.315262</td>
      <td>1981</td>
      <td>82.2</td>
      <td>178.445</td>
      <td>-18.135</td>
      <td>178.44E_-18.13N</td>
      <td>POLYGON ((178.43999999999824 -18.1299999999993...</td>
      <td>1139</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ba</td>
      <td>95659</td>
      <td>27.914065</td>
      <td>966</td>
      <td>86.0</td>
      <td>177.455</td>
      <td>-17.635</td>
      <td>177.45E_-17.63N</td>
      <td>POLYGON ((177.44999999999914 -17.6299999999993...</td>
      <td>1096</td>
    </tr>
  </tbody>
</table>
</div>



## Automation


```python
def list_vulnerable_places(threshold, df_dmg_mun, grid_mun_info, grid_new):
    pred_damage_mun = df_dmg_mun[df_dmg_mun.perc_dmg_pred <= threshold]
    grid_municipalities = grid_mun_info.rename({'NAME_2':'municipality'}, axis=1)
    # Add id information
    add_mun_info = pred_damage_mun.merge(grid_municipalities[['municipality', 'id']], on='municipality')[['municipality', 'id', 'perc_dmg_pred']]

    # Load new grid (0,01 degree resolution grid) and contemplate affected areas
    df_affected = add_mun_info.merge(grid_new, on ='id')
    df_affected = df_affected[df_affected.numbuildings != 0] # Drop 0 bluildings mini-cells

    df_out_mun_level = df_affected.sort_values('numbuildings', ascending=False).reset_index(drop=True)
    return df_out_mun_level
```

From scratch


```python
# Load grid
grid_dir = (
    Path(os.getenv("STORM_DATA_DIR"))
    / "analysis_fji/02_new_model_input/02_housing_damage/output/"
)
grid = gpd.read_file(grid_dir / "fji_0.1_degree_grid_land_overlap_new.gpkg")
grid_new = pd.read_csv(grid_dir / "grid_0.01_bld_locations.csv")

# Load municipality info
grid_mun_info = pd.read_csv(input_dir / "grid_0.01_municipality_info.csv")
```


```python
# This is a classic output from the forecast model
df_dmg_mun = fiji[['NAME_2', 'pred_perc_dmg']].rename({
    'NAME_2':'municipality',
    'pred_perc_dmg':'perc_dmg_pred'}, axis=1)
```


```python
df_out_autom = list_vulnerable_places(threshold=10, df_dmg_mun=df_dmg_mun, grid_mun_info=grid_mun_info, grid_new=grid_new)
```


```python
df_out_autom.sort_values(['IWI', 'numbuildings'], ascending=[True, False])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>municipality</th>
      <th>id</th>
      <th>perc_dmg_pred</th>
      <th>grid_point_id</th>
      <th>IWI</th>
      <th>Longitude</th>
      <th>Latitude</th>
      <th>Centroid</th>
      <th>geometry</th>
      <th>numbuildings</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13</th>
      <td>Lau</td>
      <td>470093</td>
      <td>3.480480</td>
      <td>4709</td>
      <td>71.4</td>
      <td>181.195</td>
      <td>-18.235</td>
      <td>181.19E_-18.23N</td>
      <td>POLYGON ((181.18999999999573 -18.2299999999994...</td>
      <td>307</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Lomaiviti</td>
      <td>233802</td>
      <td>-0.087076</td>
      <td>2380</td>
      <td>71.4</td>
      <td>178.835</td>
      <td>-17.685</td>
      <td>178.83E_-17.68N</td>
      <td>POLYGON ((178.82999999999788 -17.6799999999993...</td>
      <td>267</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Lomaiviti</td>
      <td>230803</td>
      <td>-0.087076</td>
      <td>2381</td>
      <td>71.4</td>
      <td>178.805</td>
      <td>-17.725</td>
      <td>178.8E_-17.72N</td>
      <td>POLYGON ((178.7999999999979 -17.71999999999933...</td>
      <td>265</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Lau</td>
      <td>487172</td>
      <td>3.480480</td>
      <td>4917</td>
      <td>71.4</td>
      <td>181.365</td>
      <td>-18.855</td>
      <td>181.36E_-18.85N</td>
      <td>POLYGON ((181.35999999999558 -18.8499999999995...</td>
      <td>260</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Lau</td>
      <td>469092</td>
      <td>3.480480</td>
      <td>4709</td>
      <td>71.4</td>
      <td>181.185</td>
      <td>-18.235</td>
      <td>181.18E_-18.23N</td>
      <td>POLYGON ((181.17999999999574 -18.2299999999994...</td>
      <td>246</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4887</th>
      <td>Tailevu</td>
      <td>193778</td>
      <td>0.241181</td>
      <td>1978</td>
      <td>85.4</td>
      <td>178.435</td>
      <td>-17.845</td>
      <td>178.43E_-17.84N</td>
      <td>POLYGON ((178.42999999999824 -17.8399999999993...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4892</th>
      <td>Tailevu</td>
      <td>192777</td>
      <td>0.241181</td>
      <td>1978</td>
      <td>85.4</td>
      <td>178.425</td>
      <td>-17.845</td>
      <td>178.42E_-17.84N</td>
      <td>POLYGON ((178.41999999999825 -17.8399999999993...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4920</th>
      <td>Macuata</td>
      <td>242703</td>
      <td>0.270438</td>
      <td>2470</td>
      <td>85.4</td>
      <td>178.925</td>
      <td>-16.605</td>
      <td>178.92E_-16.6N</td>
      <td>POLYGON ((178.9199999999978 -16.59999999999915...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4929</th>
      <td>Macuata</td>
      <td>268729</td>
      <td>0.270438</td>
      <td>2672</td>
      <td>85.4</td>
      <td>179.185</td>
      <td>-16.605</td>
      <td>179.18E_-16.6N</td>
      <td>POLYGON ((179.17999999999756 -16.5999999999991...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4949</th>
      <td>Cakaudrove</td>
      <td>329760</td>
      <td>2.576253</td>
      <td>3275</td>
      <td>85.4</td>
      <td>179.795</td>
      <td>-16.305</td>
      <td>179.79E_-16.3N</td>
      <td>POLYGON ((179.789999999997 -16.29999999999911,...</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>4977 rows Ã— 10 columns</p>
</div>
