```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import geopandas as gpd
import os
from pathlib import Path
```


```python
input_dir = (
    Path(os.getenv("STORM_DATA_DIR"))
    / "analysis_vnm/02_model_features/02_housing_damage/input/"
)
output_dir = (
    Path(os.getenv("STORM_DATA_DIR"))
    / "analysis_vnm/02_model_features/02_housing_damage/output/"
)

# Load Fiji
vietnam = gpd.read_file(
    input_dir / "adm2_shp_fixed.gpkg"
)
vietnam = vietnam.to_crs('EPSG:4326')

# Load housing damage dataset 1
df_housing = pd.read_csv(input_dir / "vietnam_damage_manual_labeling.csv")

# Load housing damage dataset 2
df_housing_2 = pd.read_csv(input_dir / "vietnam_IMHEN_damage.csv")
```

## Cleaning datasets


```python
# Cleaning dataset 1

df_housing['typhoon_name'] = df_housing.Name.str.split().str.get(0)
# Destroyed
dest = df_housing['Houses destroyed (Damaged)'].str.split('(').str.get(0).to_list()
df_housing['houses_destroyed'] = [int(val.split()[0].replace(',','')) for val in dest]
# Damaged
dam = df_housing['Houses destroyed (Damaged)'].str.split('(').str.get(1).to_list()
df_housing['houses_damaged'] = [int(val.split(')')[0].replace(',','')) for val in dam]
# Total damage
df_housing['total_bld_dmg'] = df_housing['houses_damaged'] + df_housing['houses_destroyed'].fillna(0)

# Areas affected
df_housing['region_affected'] = df_housing['Main impacted area'].str.split(', ')

df_housing_dmg = df_housing[['typhoon_name', 'Year', 'total_bld_dmg', 'region_affected']]
```


```python
# Cleaning dataset 2
df_housing_2['typhoon_name'] = df_housing_2.Typhoon
df_housing_2['Year'] = df_housing_2.Dates.apply(lambda x: x[-4:])
df_housing_2['houses_destroyed'] = df_housing_2.Destroyed
df_housing_2['houses_damaged'] = df_housing_2.Damaged
df_housing_2['total_bld_dmg']= df_housing_2['houses_damaged'] + df_housing_2['houses_destroyed'].fillna(0)
df_housing_2['region_affected'] = df_housing_2.Region.str.split(', ')
df_housing_dmg_2 = df_housing_2[['typhoon_name', 'Year', 'total_bld_dmg', 'region_affected']]

# Merging the 2 datasets
df_housing_dmg_total = pd.concat([df_housing_dmg, df_housing_dmg_2]).drop_duplicates(['typhoon_name', 'Year'], keep='first').reset_index(drop=True)
df_housing_dmg_total
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>typhoon_name</th>
      <th>Year</th>
      <th>total_bld_dmg</th>
      <th>region_affected</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Linda</td>
      <td>1997</td>
      <td>216054.0</td>
      <td>[MD]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Damrey</td>
      <td>2005</td>
      <td>12770.0</td>
      <td>[RRD, NC, NE]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Xangsane</td>
      <td>2006</td>
      <td>349348.0</td>
      <td>[NC, SC, C]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Durian</td>
      <td>2006</td>
      <td>241438.0</td>
      <td>[SC, SE, MD]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Lekima</td>
      <td>2007</td>
      <td>113623.0</td>
      <td>[NW, NC, SC]</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Kammuri</td>
      <td>2008</td>
      <td>26635.0</td>
      <td>[NE, NW]</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Ketsana</td>
      <td>2009</td>
      <td>264000.0</td>
      <td>[NC, SC, C]</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Conson</td>
      <td>2010</td>
      <td>727.0</td>
      <td>[RRD, NC, SC]</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Mindulle</td>
      <td>2010</td>
      <td>46963.0</td>
      <td>[NC, SC]</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Haima</td>
      <td>2011</td>
      <td>4045.0</td>
      <td>[RRD, NC]</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Nesat</td>
      <td>2011</td>
      <td>2587.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Pakhar</td>
      <td>2012</td>
      <td>9561.0</td>
      <td>[SC, SE]</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Son</td>
      <td>2012</td>
      <td>56109.0</td>
      <td>[RRD, NC]</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Mangkhut</td>
      <td>2013</td>
      <td>1633.0</td>
      <td>[NE, RRD]</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Wutip</td>
      <td>2013</td>
      <td>201869.0</td>
      <td>[Quang Binh, Quang Tri, Thua Thien Hue, Ha Tinh]</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Nari</td>
      <td>2013</td>
      <td>42586.0</td>
      <td>[NC]</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Kalmaegi</td>
      <td>2014</td>
      <td>4117.0</td>
      <td>[NE, RRD]</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Mirinae</td>
      <td>2016</td>
      <td>13612.0</td>
      <td>[RRD]</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Talas</td>
      <td>2017</td>
      <td>10878.0</td>
      <td>[NC]</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Doksuri</td>
      <td>2017</td>
      <td>194970.0</td>
      <td>[NE, RRD, NC, SC]</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Damrey</td>
      <td>2017</td>
      <td>137550.0</td>
      <td>[NC, SC, C]</td>
    </tr>
    <tr>
      <th>21</th>
      <td>A</td>
      <td>2020</td>
      <td>53284.0</td>
      <td>[NC, SC, C, SE, MD]</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Pakhar</td>
      <td>2012</td>
      <td>9561.0</td>
      <td>[SC, SE]</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Vicente</td>
      <td>2012</td>
      <td>496.0</td>
      <td>[NE]</td>
    </tr>
    <tr>
      <th>24</th>
      <td>KaiTak</td>
      <td>2012</td>
      <td>1297.0</td>
      <td>[NE]</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Gaemi</td>
      <td>2012</td>
      <td>119.0</td>
      <td>[SC, C]</td>
    </tr>
    <tr>
      <th>26</th>
      <td>SonTinh</td>
      <td>2012</td>
      <td>60833.0</td>
      <td>[NE, RRD]</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Bebinca</td>
      <td>2013</td>
      <td>143.0</td>
      <td>[NE, NC]</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Jebi</td>
      <td>2013</td>
      <td>1845.0</td>
      <td>[NE, NC]</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Mangkut</td>
      <td>2013</td>
      <td>1633.0</td>
      <td>[RRD, NC]</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Number 8</td>
      <td>2013</td>
      <td>203.0</td>
      <td>[NC, SC]</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Wutip</td>
      <td>2013</td>
      <td>NaN</td>
      <td>[NC, SC]</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Nari</td>
      <td>2013</td>
      <td>42586.0</td>
      <td>[NC, SC]</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Haiyan</td>
      <td>2013</td>
      <td>NaN</td>
      <td>[NE, NC]</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Pudol</td>
      <td>2013</td>
      <td>3067.0</td>
      <td>[SC, C]</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Rammasun</td>
      <td>2014</td>
      <td>1813.0</td>
      <td>[NE, RRD]</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Kalmage</td>
      <td>2014</td>
      <td>4117.0</td>
      <td>[NE, RRD]</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Sinlaku</td>
      <td>2020</td>
      <td>3321.0</td>
      <td>[SC,C]</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Kujira</td>
      <td>2015</td>
      <td>1386.0</td>
      <td>[NE, RRD]</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Mirinae</td>
      <td>2016</td>
      <td>13612.0</td>
      <td>[NE, RRD]</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Dianmu</td>
      <td>2016</td>
      <td>797.0</td>
      <td>[NE, RRD]</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Rai</td>
      <td>2016</td>
      <td>595.0</td>
      <td>[NC, SC]</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Tropical depression</td>
      <td>2016</td>
      <td>768.0</td>
      <td>[NC, SC]</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Talas</td>
      <td>2017</td>
      <td>10878.0</td>
      <td>[NE, NC]</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Sonca</td>
      <td>2017</td>
      <td>187.0</td>
      <td>[NC]</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Doksuri</td>
      <td>2017</td>
      <td>17558.0</td>
      <td>[NE, SC]</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Damrey</td>
      <td>2017</td>
      <td>23261.0</td>
      <td>[NC, SC, C, SE]</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Bebinca</td>
      <td>2018</td>
      <td>NaN</td>
      <td>[NE, NC]</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Wipha</td>
      <td>2019</td>
      <td>369.0</td>
      <td>[NE, RRD]</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Podul</td>
      <td>2019</td>
      <td>874.0</td>
      <td>[RRD, NC]</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Matmo</td>
      <td>2019</td>
      <td>1486.0</td>
      <td>[SC, C]</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Nakri</td>
      <td>2019</td>
      <td>NaN</td>
      <td>[SC, SE]</td>
    </tr>
  </tbody>
</table>
</div>




```python
# df_aux = df_housing_dmg.explode('region_affected')
# adm1_regions = vietnam[['ADM1_EN', 'region']]
# df_aux.merge(adm1_regions, left_on='region_affected', right_on='region')
```


```python
# Basically, all this provinces belong to the region NC
df_housing_dmg_total.at[14, 'region_affected'] = ['NC']

# The typhoons of 2020 (explicitely called "A succession of typhoons (no.5-12)") doesnt give me much information
# Also, the 'Tropical Depression' of 2016 doens't say much.
# Also, 'Number 8' I think is included in the data from the first dataset
# We should dive deep into this
# For now we skip them
df_housing_dmg_total = df_housing_dmg_total.drop([21, 30, 42]).reset_index(drop=True)
```


```python
# Also, these are the locations affected by NESAT that I had to looked for.
df_housing_dmg_total.at[10, 'region_affected'] = "['RRD', 'NC', 'NE']"
```


```python
# There are 4 typhoons without values in the 'damaged_houses' feature.
# Is not correct to consider them because our value of prediction is for the total number of houses affected.
# These are 4 typhoons. I will drop them.
df_housing_dmg_total = df_housing_dmg_total.dropna().reset_index(drop=True)
```


```python
# Year as string
df_housing_dmg_total['Year'] = df_housing_dmg_total.Year.astype(int)
```


```python
# Drop duplicates from the second dataset.
# keep the ones on the first dataset, I trust it more.
df_housing_dmg_total = df_housing_dmg_total.drop_duplicates(subset=['typhoon_name','Year'], keep='first')
```


```python
df_housing_dmg_total = df_housing_dmg_total.sort_values('Year').reset_index(drop=True)
```


```python
# Fix some things on the damage data
import ast
df_housing_dmg_total.region_affected.replace({
    "['SC,C']": "['SC', 'C']"
}, inplace=True)
df_housing_dmg_total['region_affected'] = df_housing_dmg_total['region_affected'].astype('str').apply(ast.literal_eval)
```


```python
# Fix some other things on the damage data
df_housing_dmg_total.typhoon_name = df_housing_dmg_total.typhoon_name.str.upper()
damage_data = df_housing_dmg_total[~df_housing_dmg_total['typhoon_name'].isin(['KALMAGE', 'SONTINH', 'MANGKHUT'])].reset_index(drop=True)
damage_data['typhoon_name'].replace({
    'SON': 'SON-TINH',
    'KAITAK': 'KAI-TAK',
    'PUDOL': 'PODUL',
    'MANGKUT': 'MANGKHUT',
    'MATMO': 'BULBUL:MATMO'
}, inplace=True)
```


```python
damage_data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>typhoon_name</th>
      <th>Year</th>
      <th>total_bld_dmg</th>
      <th>region_affected</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>LINDA</td>
      <td>1997</td>
      <td>216054.0</td>
      <td>[MD]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>DAMREY</td>
      <td>2005</td>
      <td>12770.0</td>
      <td>[RRD, NC, NE]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>XANGSANE</td>
      <td>2006</td>
      <td>349348.0</td>
      <td>[NC, SC, C]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>DURIAN</td>
      <td>2006</td>
      <td>241438.0</td>
      <td>[SC, SE, MD]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>LEKIMA</td>
      <td>2007</td>
      <td>113623.0</td>
      <td>[NW, NC, SC]</td>
    </tr>
    <tr>
      <th>5</th>
      <td>KAMMURI</td>
      <td>2008</td>
      <td>26635.0</td>
      <td>[NE, NW]</td>
    </tr>
    <tr>
      <th>6</th>
      <td>KETSANA</td>
      <td>2009</td>
      <td>264000.0</td>
      <td>[NC, SC, C]</td>
    </tr>
    <tr>
      <th>7</th>
      <td>CONSON</td>
      <td>2010</td>
      <td>727.0</td>
      <td>[RRD, NC, SC]</td>
    </tr>
    <tr>
      <th>8</th>
      <td>MINDULLE</td>
      <td>2010</td>
      <td>46963.0</td>
      <td>[NC, SC]</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NESAT</td>
      <td>2011</td>
      <td>2587.0</td>
      <td>[RRD, NC, NE]</td>
    </tr>
    <tr>
      <th>10</th>
      <td>HAIMA</td>
      <td>2011</td>
      <td>4045.0</td>
      <td>[RRD, NC]</td>
    </tr>
    <tr>
      <th>11</th>
      <td>KAI-TAK</td>
      <td>2012</td>
      <td>1297.0</td>
      <td>[NE]</td>
    </tr>
    <tr>
      <th>12</th>
      <td>PAKHAR</td>
      <td>2012</td>
      <td>9561.0</td>
      <td>[SC, SE]</td>
    </tr>
    <tr>
      <th>13</th>
      <td>SON-TINH</td>
      <td>2012</td>
      <td>56109.0</td>
      <td>[RRD, NC]</td>
    </tr>
    <tr>
      <th>14</th>
      <td>GAEMI</td>
      <td>2012</td>
      <td>119.0</td>
      <td>[SC, C]</td>
    </tr>
    <tr>
      <th>15</th>
      <td>VICENTE</td>
      <td>2012</td>
      <td>496.0</td>
      <td>[NE]</td>
    </tr>
    <tr>
      <th>16</th>
      <td>PODUL</td>
      <td>2013</td>
      <td>3067.0</td>
      <td>[SC, C]</td>
    </tr>
    <tr>
      <th>17</th>
      <td>MANGKHUT</td>
      <td>2013</td>
      <td>1633.0</td>
      <td>[RRD, NC]</td>
    </tr>
    <tr>
      <th>18</th>
      <td>JEBI</td>
      <td>2013</td>
      <td>1845.0</td>
      <td>[NE, NC]</td>
    </tr>
    <tr>
      <th>19</th>
      <td>BEBINCA</td>
      <td>2013</td>
      <td>143.0</td>
      <td>[NE, NC]</td>
    </tr>
    <tr>
      <th>20</th>
      <td>NARI</td>
      <td>2013</td>
      <td>42586.0</td>
      <td>[NC]</td>
    </tr>
    <tr>
      <th>21</th>
      <td>WUTIP</td>
      <td>2013</td>
      <td>201869.0</td>
      <td>[NC]</td>
    </tr>
    <tr>
      <th>22</th>
      <td>KALMAEGI</td>
      <td>2014</td>
      <td>4117.0</td>
      <td>[NE, RRD]</td>
    </tr>
    <tr>
      <th>23</th>
      <td>RAMMASUN</td>
      <td>2014</td>
      <td>1813.0</td>
      <td>[NE, RRD]</td>
    </tr>
    <tr>
      <th>24</th>
      <td>KUJIRA</td>
      <td>2015</td>
      <td>1386.0</td>
      <td>[NE, RRD]</td>
    </tr>
    <tr>
      <th>25</th>
      <td>RAI</td>
      <td>2016</td>
      <td>595.0</td>
      <td>[NC, SC]</td>
    </tr>
    <tr>
      <th>26</th>
      <td>MIRINAE</td>
      <td>2016</td>
      <td>13612.0</td>
      <td>[RRD]</td>
    </tr>
    <tr>
      <th>27</th>
      <td>DIANMU</td>
      <td>2016</td>
      <td>797.0</td>
      <td>[NE, RRD]</td>
    </tr>
    <tr>
      <th>28</th>
      <td>SONCA</td>
      <td>2017</td>
      <td>187.0</td>
      <td>[NC]</td>
    </tr>
    <tr>
      <th>29</th>
      <td>DOKSURI</td>
      <td>2017</td>
      <td>194970.0</td>
      <td>[NE, RRD, NC, SC]</td>
    </tr>
    <tr>
      <th>30</th>
      <td>DAMREY</td>
      <td>2017</td>
      <td>137550.0</td>
      <td>[NC, SC, C]</td>
    </tr>
    <tr>
      <th>31</th>
      <td>TALAS</td>
      <td>2017</td>
      <td>10878.0</td>
      <td>[NC]</td>
    </tr>
    <tr>
      <th>32</th>
      <td>PODUL</td>
      <td>2019</td>
      <td>874.0</td>
      <td>[RRD, NC]</td>
    </tr>
    <tr>
      <th>33</th>
      <td>WIPHA</td>
      <td>2019</td>
      <td>369.0</td>
      <td>[NE, RRD]</td>
    </tr>
    <tr>
      <th>34</th>
      <td>BULBUL:MATMO</td>
      <td>2019</td>
      <td>1486.0</td>
      <td>[SC, C]</td>
    </tr>
    <tr>
      <th>35</th>
      <td>SINLAKU</td>
      <td>2020</td>
      <td>3321.0</td>
      <td>[SC,C]</td>
    </tr>
  </tbody>
</table>
</div>




```python
events_minus2 = len(damage_data.region_affected[damage_data.region_affected.apply(lambda x: len(x) < 2)])
events_2 = len(damage_data.region_affected[damage_data.region_affected.apply(lambda x: len(x) == 2)])
events_plus2 = len(damage_data.region_affected[damage_data.region_affected.apply(lambda x: len(x) > 2)])

print(events_minus2, events_2, events_plus2)
```

    9 18 9


## Save everything


```python
damage_data.to_csv(input_dir / 'viet_damage_adm1_level_fixed.csv', index=False)
```

## Some maps


```python
import ast
damage_data = pd.read_csv(input_dir / 'viet_damage_adm1_level.csv')
damage_data['region_affected'] = damage_data['region_affected'].astype('str').apply(ast.literal_eval)
df_housing_dmg_total = damage_data.copy()
typhoons = df_housing_dmg_total.iloc[[3,16,15,31]].typhoon_name.to_list()
```


```python
df_housing_exp = df_housing_dmg_total.explode('region_affected')
#typhoons = df_housing_dmg['typhoon_name'].unique()
fig, ax = plt.subplots(1,4, figsize=(15,6))
ax = ax.flatten()
i=0
for t in typhoons:
    df_aux = df_housing_exp[df_housing_exp['typhoon_name'] == t][['typhoon_name','region_affected','total_bld_dmg']]
    regions = df_aux['region_affected'].to_list()
    vietnam['colors'] = 'lightblue'  # Default color for all provinces
    vietnam.loc[vietnam['region'].isin(regions), 'colors'] = 'red'  # Color for the specified provinces

    # Plot Vietnam regions with the specified colors
    vietnam.plot(ax=ax[i], color=vietnam['colors'], edgecolor='0.3', linewidth=0.2, legend=True, label='Region Colors')
    ax[i].set_title(t.upper())
    i+=1

plt.tight_layout()
plt.show()
```



![png](00.1_damage_data_exploration_files/00.1_damage_data_exploration_20_0.png)



## New damage dataset


```python
new_dmg_dir = input_dir / "Impact data/vndma_disaster_damage_data"
files = os.listdir(new_dmg_dir)
file_clean = []
for file in files:
    if (file.endswith('.xls')) or (file.endswith('.xlsm')):
        file_clean.append(file)

# Parameters
par1 = 'Damaged, Unroofed '
par2 = 'Completely destroyed/Collapsed'
par3 = 'Population affected (Households)'

file_clean_sorted = sorted(file_clean)
file_clean_sorted
```




    ['Vietnam_2010_Disaster Losses and Damages.xls',
     'Vietnam_2011_Disaster Losses and Damages_typhoon.xlsm',
     'Vietnam_2012_Disaster Losses and Damages_typhoon.xls',
     'Vietnam_2013_Disaster Losses and Damages.xls',
     'Vietnam_2014_Disaster Losses and Damages.xls',
     'Vietnam_2015_Disaster Losses and Damages.xls',
     'Vietnam_2016_Disaster Losses and Damages.xls',
     'Vietnam_2017_Disaster Losses and Damages_typhoon.xls',
     'Vietnam_2020_Disaster Losses and Damages_typhoon.xls']



### Exploring each file


```python
event1 = pd.read_excel(new_dmg_dir / file_clean_sorted[0], header=3) #2010
par4 = ' # HHs affected, of which:'
event1[event1.PARAMETER == par4] # USELESS
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CATEGORY</th>
      <th>PARAMETER</th>
      <th>UNIT</th>
      <th>Flashfloods</th>
      <th>Tornadoes, Lightnings and Hails</th>
      <th>Typhoon #1</th>
      <th>Typhoon #2</th>
      <th>Typhoon #3</th>
      <th>Floods in Central prov 1-5 Oct</th>
      <th>Floods in Central prov 14-18 Oct</th>
      <th>Floods in  Phú Yên - Ninh Thuận</th>
      <th>Floods in Central Prov. 14-17 Nov</th>
      <th>Heavy rains and floods Nov/Dec</th>
      <th>North-Eastern Monsoon 14-16 Dec</th>
      <th>TOTAL</th>
      <th>Unnamed: 15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>NaN</td>
      <td># HHs affected, of which:</td>
      <td>HH</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
event2 = pd.read_excel(new_dmg_dir / file_clean_sorted[1]) #2011
event2.head() #USELESS
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wHaTiSnAmE</th>
      <th>Unnamed: 1</th>
      <th>Set_Var</th>
      <th>Unnamed: 3</th>
      <th>Auto_Hide</th>
      <th>Unnamed: 5</th>
      <th>On_All_Windows</th>
      <th>Unnamed: 7</th>
      <th>Select_Windows</th>
      <th>Unnamed: 9</th>
      <th>Ktra_Sheet</th>
      <th>Unnamed: 11</th>
      <th>Copy_sheet</th>
      <th>Unnamed: 13</th>
      <th>read_Sheet</th>
      <th>Unnamed: 15</th>
      <th>read_Book</th>
      <th>Unnamed: 17</th>
      <th>Save_Templete</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-710</td>
      <td>NaN</td>
      <td>Deleted By Kaspersky</td>
      <td>NaN</td>
      <td>Del</td>
      <td>NaN</td>
      <td>Del</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Deleted By Kaspe</td>
      <td>NaN</td>
      <td>Del</td>
      <td>NaN</td>
      <td>Deleted By Kaspe</td>
      <td>NaN</td>
      <td>Deleted By Kasp</td>
      <td>NaN</td>
      <td>Del</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Deleted By Kaspersky Lab</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Deleted</td>
      <td>NaN</td>
      <td>Delete</td>
      <td>NaN</td>
      <td>Del</td>
      <td>NaN</td>
      <td>Deleted By</td>
      <td>NaN</td>
      <td>Del</td>
      <td>NaN</td>
      <td>Del</td>
      <td>NaN</td>
      <td>Dele</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
event3 = pd.read_excel(new_dmg_dir / file_clean_sorted[2], header=3) #2012
event3 # USELESS
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Region</th>
      <th>Unnamed: 1</th>
      <th>Total # of incidents</th>
      <th>Typhoon</th>
      <th>Tropical Low pressures and monsoons</th>
      <th>Floods</th>
      <th>Flashfloods and landslides</th>
      <th>Tornadoes, lightnings and Hails</th>
      <th>Storm surges and inundation</th>
      <th>Droughts</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>incident</td>
      <td>incident</td>
      <td>incident</td>
      <td>incident</td>
      <td>incident</td>
      <td>incident</td>
      <td>incident</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Country-wide</td>
      <td>NaN</td>
      <td>198.0</td>
      <td>6</td>
      <td>2</td>
      <td>3</td>
      <td>69</td>
      <td>108</td>
      <td>8</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Province/city</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>Lai Châu</td>
      <td>2.0</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>by province</td>
      <td>Sơn La</td>
      <td>13.0</td>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>61</th>
      <td>NaN</td>
      <td>Bạc Liêu</td>
      <td>4.0</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>62</th>
      <td>NaN</td>
      <td>Cà Mau</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>63</th>
      <td>NaN</td>
      <td>Kiên Giang</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>64</th>
      <td>NaN</td>
      <td>An Giang</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>65</th>
      <td>NaN</td>
      <td>Cần Thơ</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>5</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>66 rows × 10 columns</p>
</div>




```python
event4 = pd.read_excel(new_dmg_dir / file_clean_sorted[3], header=2) #2013
event_2013 = event4[event4.Parameter == par3]
event_2013
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Category</th>
      <th>Code</th>
      <th>Parameter</th>
      <th>Unit</th>
      <th>Hoà Bình</th>
      <th>Sơn La</th>
      <th>Điện Biên</th>
      <th>Lai Châu</th>
      <th>Lào Cai</th>
      <th>Yên Bái</th>
      <th>...</th>
      <th>Cần Thơ</th>
      <th>Bạc Liêu</th>
      <th>Kiên Giang</th>
      <th>Trà Vinh</th>
      <th>Cà Mau</th>
      <th>Long An</th>
      <th>Vĩnh Long</th>
      <th>TOTAL</th>
      <th>28 coastal provinces</th>
      <th>Unnamed: 69</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>15</th>
      <td>NaN</td>
      <td>NG04</td>
      <td>Population affected (Households)</td>
      <td>HH</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1691.0</td>
      <td>20.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 70 columns</p>
</div>




```python
event5 = pd.read_excel(new_dmg_dir / file_clean_sorted[4], header=2) #2014
event_2014 = event5[event5.Parameter == par3]
event_2014
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Category</th>
      <th>Code</th>
      <th>Parameter</th>
      <th>Unit</th>
      <th>Hoà Bình</th>
      <th>Sơn La</th>
      <th>Điện Biên</th>
      <th>Lai Châu</th>
      <th>Lào Cai</th>
      <th>Yên Bái</th>
      <th>...</th>
      <th>Tiền Giang</th>
      <th>Cần Thơ</th>
      <th>Bạc Liêu</th>
      <th>Kiên Giang</th>
      <th>Trà Vinh</th>
      <th>Cà Mau</th>
      <th>Long An</th>
      <th>Vĩnh Long</th>
      <th>TOTAL</th>
      <th>28 coastal provinces</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11</th>
      <td>NaN</td>
      <td>NG04</td>
      <td>Population affected (Households)</td>
      <td>HH</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>19.0</td>
      <td>337.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>697.0</td>
      <td>18.0</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 69 columns</p>
</div>




```python
event6 = pd.read_excel(new_dmg_dir / file_clean_sorted[5], header=2) #2015
event6[event6.Parameter == par3] #USELESS
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Category</th>
      <th>Code</th>
      <th>Parameter</th>
      <th>Unit</th>
      <th>Other hazards</th>
      <th>Droughts</th>
      <th>Tornadoes, Lightnings</th>
      <th>Flashfloods, Landslides</th>
      <th>3/2015 flood in the Central Region and other small scale floods</th>
      <th>Floods in the Northern provinces and Thanh Hoa 24/7-06/8</th>
      <th>Typhoon #1</th>
      <th>Typhoon #3 and its aftermath</th>
      <th>Floods in the Northern provinces and Thanh Hoa, Nghe An 17-22/9</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9</th>
      <td>NaN</td>
      <td>NG04</td>
      <td>Population affected (Households)</td>
      <td>HH</td>
      <td>2170.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>951.0</td>
      <td>215.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3336.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
event7 = pd.read_excel(new_dmg_dir / file_clean_sorted[6], header=0) #2016
event7.head() #USELESS
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BIỂU 01/TKNTH</th>
      <th>Unnamed: 1</th>
      <th>CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM</th>
      <th>Unnamed: 3</th>
      <th>Unnamed: 4</th>
      <th>Unnamed: 5</th>
      <th>Unnamed: 6</th>
      <th>Unnamed: 7</th>
      <th>Unnamed: 8</th>
      <th>Unnamed: 9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Độc lập - Tự do - Hạnh phúc</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>THỐNG KÊ NHANH TÌNH HÌNH THIỆT HẠI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>(Kèm theo Thông tư liên tịch số         /2015/...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Thời gian:</td>
      <td>NaN</td>
      <td>Đơn vị báo cáo:</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
event8 = pd.read_excel(new_dmg_dir / file_clean_sorted[7], header=0) #2017
event8.head() #USELESS
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BIỂU 01/TKNTH</th>
      <th>Unnamed: 1</th>
      <th>CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM</th>
      <th>Unnamed: 3</th>
      <th>Unnamed: 4</th>
      <th>Unnamed: 5</th>
      <th>Unnamed: 6</th>
      <th>Unnamed: 7</th>
      <th>Unnamed: 8</th>
      <th>Unnamed: 9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Độc lập - Tự do - Hạnh phúc</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>THỐNG KÊ NHANH TÌNH HÌNH THIỆT HẠI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>(Kèm theo Thông tư liên tịch số         /2015/...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Thời gian:</td>
      <td>NaN</td>
      <td>Đơn vị báo cáo:</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
event9 = pd.read_excel(new_dmg_dir / file_clean_sorted[8], header=0) #2020
event9.head() #USELESS
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BIỂU 01/TKNTH</th>
      <th>Unnamed: 1</th>
      <th>CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM</th>
      <th>Unnamed: 3</th>
      <th>Unnamed: 4</th>
      <th>Unnamed: 5</th>
      <th>Unnamed: 6</th>
      <th>Unnamed: 7</th>
      <th>Unnamed: 8</th>
      <th>Unnamed: 9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Độc lập - Tự do - Hạnh phúc</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>THỐNG KÊ NHANH TÌNH HÌNH THIỆT HẠI</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>(Kèm theo Thông tư liên tịch số         /2015/...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Thời gian:</td>
      <td>NaN</td>
      <td>Đơn vị báo cáo:</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



### Useful events


```python
viet_2013 = event_2013.drop('Unnamed: 69', axis=1)
viet_2013['Year'] = 2013

viet_2014 = event_2014.copy()
viet_2014['Year'] = 2014

new_impact_data = pd.concat([viet_2013, viet_2014])
provinces = new_impact_data.columns[4:-3]

# merge with vietnam
new_impact_data_clean = new_impact_data.set_index('Year')[provinces].transpose().reset_index(drop=False, names='provinces')
impact_merged = gpd.GeoDataFrame(
    new_impact_data_clean.merge(vietnam, left_on='provinces', right_on='ADM1_VI', how='right')[
        ['ADM1_VI', 'ADM1_PCODE', 'region', 2013, 2014, 'geometry']],
        geometry='geometry').fillna(0)
```


```python
fig, ax = plt.subplots(1,2, figsize=(10,5))
year=2013
impact_merged.plot(column=year, legend=True, cmap='viridis', ax=ax[0])
ax[0].set_title('Impact data, {}\n(Households affected)'.format(year))

year=2014
impact_merged.plot(column=year, legend=True, cmap='viridis', ax=ax[1])
ax[1].set_title('Impact data, {}\n(Households affected)'.format(year))

plt.show()
```



![png](00.1_damage_data_exploration_files/00.1_damage_data_exploration_35_0.png)
